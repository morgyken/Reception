$(document).ready(function(){$(".insured input[type=radio]").click(function(){b()});function b(){if($("#s_schemes").is(":checked")){if($("#schemes").hasClass("hidden")){$("#schemes").removeClass("hidden")}}else{if(!$("#schemes").hasClass("hidden")){$("#schemes").addClass("hidden")}}}b();$("#s_schemes,#h_schemes").click(function(){b()});function f(j){$("#"+l+" .scheme").empty();var i="";var l=$(j).parent().parent().parent().parent().attr("id");var k=$(j).val();if(!k){return}$.ajax({url:SCHEMES_URL,data:{id:k},success:function(m){$.each(m,function(n,o){i+='<option value="'+n+'">'+o+"</option>"});$("#"+l+" .scheme").html(i)}})}$(".company").change(function(){f(this)});var d=5;var h=$(".schemes");var c=$(".add_button");var a=1;var g=$("#wrapper1").html();$(c).click(function(j){j.preventDefault();if(a<d){a++;var i="wrapper"+a;var k="Insurance "+a;$(h).append("<h5>"+k+"</h5><div id='"+i+"'>"+g+"</div>");$(".date").datepicker({dateFormat:"yy-mm-dd",changeYear:true,changeMonth:true,defaultDate:"-20y",yearRange:"1900:+0"});$(".company").change(function(){f(this)})}});$(".date").datepicker({dateFormat:"yy-mm-dd",changeYear:true,changeMonth:true,defaultDate:"-20y",yearRange:"1900:+0"});$("form").submit(function(k){var j=$(this);var i=$("<input>").attr("type","hidden").attr("name","imagesrc").val(IMAGE_SRC);j.append($(i))});$("#photo").change(function(j){var i=URL.createObjectURL(j.target.files[0]);$("#thephoto").attr("src",i);e(i,function(k){IMAGE_SRC=k})});function e(j,k){var i=new Image();i.crossOrigin="Anonymous";i.onload=function(){var m=document.createElement("CANVAS");var l=m.getContext("2d");var n;m.height=this.height;m.width=this.width;l.drawImage(this,0,0);n=m.toDataURL("image/png");k(n)};i.src=j}});